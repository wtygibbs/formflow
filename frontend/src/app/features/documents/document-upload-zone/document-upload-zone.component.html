<div hlmCard>
  <div hlmCardContent>
    <div
      cdkDropList
      (cdkDropListDropped)="onFilesDropped($event)"
      class="border-2 border-dashed rounded-lg transition-all duration-200"
      [class.border-primary]="isDraggingOver()"
      [class.bg-primary/5]="isDraggingOver()"
      [class.border-muted-foreground/30]="!isDraggingOver()"
      (dragover)="onDragOver($event)"
      (dragleave)="onDragLeave($event)"
      (drop)="onDrop($event)"
    >
      <div class="p-8 text-center">
        @if (fileQueue().length === 0) {
          <!-- Empty State -->
          <div class="space-y-4">
            <div class="flex justify-center">
              <div class="w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center">
                <span class="text-3xl">üìÑ</span>
              </div>
            </div>
            <div>
              <h3 class="text-lg font-semibold mb-1">Drop files here to upload</h3>
              <p class="text-sm text-muted-foreground mb-4">
                or click to browse ‚Ä¢ PDF, PNG, JPG, JPEG, TIFF ‚Ä¢ Max 10MB
              </p>
            </div>
            <label hlmBtn class="cursor-pointer">
              <input
                type="file"
                (change)="onFileSelected($event)"
                accept=".pdf,.png,.jpg,.jpeg,.tiff"
                multiple
                hidden
              />
              Browse Files
            </label>
          </div>
        } @else {
          <!-- File Queue -->
          <div class="space-y-3">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-lg font-semibold">
                {{ fileQueue().length }} file(s) ready to upload
              </h3>
              <div class="flex gap-2">
                <button hlmBtn variant="outline" size="sm" (click)="clearQueue()">
                  Clear All
                </button>
                <button hlmBtn size="sm" (click)="uploadFiles()" [disabled]="uploading()">
                  @if (uploading()) {
                    <hlm-spinner class="size-4 mr-2" />
                  }
                  Upload {{ fileQueue().length }} File(s)
                </button>
              </div>
            </div>

            <!-- File List -->
            <div class="space-y-2 max-h-64 overflow-y-auto">
              @for (queuedFile of fileQueue(); track queuedFile.id) {
                <div class="flex items-center gap-3 p-3 bg-muted/50 rounded-lg hover:bg-muted transition-colors">
                  <!-- File Icon -->
                  <div class="flex-shrink-0 w-10 h-10 rounded bg-primary/10 flex items-center justify-center">
                    @switch (queuedFile.type) {
                      @case ('application/pdf') {
                        <span class="text-lg">üìÑ</span>
                      }
                      @case ('image/png') {
                        <span class="text-lg">üñºÔ∏è</span>
                      }
                      @case ('image/jpeg') {
                        <span class="text-lg">üñºÔ∏è</span>
                      }
                      @case ('image/jpg') {
                        <span class="text-lg">üñºÔ∏è</span>
                      }
                      @case ('image/tiff') {
                        <span class="text-lg">üñºÔ∏è</span>
                      }
                      @default {
                        <span class="text-lg">üìé</span>
                      }
                    }
                  </div>

                  <!-- File Info -->
                  <div class="flex-1 min-w-0">
                    <p class="font-medium text-sm truncate" [title]="queuedFile.name">
                      {{ queuedFile.name }}
                    </p>
                    <p class="text-xs text-muted-foreground">
                      {{ queuedFile.sizeFormatted }}
                    </p>
                  </div>

                  <!-- Remove Button -->
                  <button
                    hlmBtn
                    variant="ghost"
                    size="sm"
                    class="flex-shrink-0"
                    (click)="removeFromQueue(queuedFile.id)"
                    [disabled]="uploading()"
                  >
                    ‚úï
                  </button>
                </div>
              }
            </div>

            <!-- Add More Files -->
            <div class="pt-3 border-t">
              <label hlmBtn variant="outline" size="sm" class="cursor-pointer">
                <input
                  type="file"
                  (change)="onFileSelected($event)"
                  accept=".pdf,.png,.jpg,.jpeg,.tiff"
                  multiple
                  hidden
                />
                + Add More Files
              </label>
            </div>
          </div>
        }
      </div>
    </div>
  </div>
</div>
